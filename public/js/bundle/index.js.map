{"mappings":"IAWgCA,KAAAA,qBAClBA,EAAEC,WAAaD,EAAEE,QAAUF,mCCZ5BG,EAAY,WAClBC,EAAMC,SAASC,cAAc,UAC/BF,GAAIA,EAAGG,cAAcC,YAAYJ,IAGzBK,EAAY,CAACC,EAAMC,KAC/BR,UACMS,EAAAA,4BAAqCF,MAASC,UACpDN,SAASC,cAAc,QAAQO,mBAAmB,aAAcD,GAChEE,OAAOC,WAAWZ,EAAW,MCgBjBa,EAASC,cAQI,mBANNC,EAAAA,CACjBC,OAAQ,MACRC,IAAK,0BAIEC,KAAKC,QAAsBC,SAASC,QAAO,SAC3CC,GACRC,QAAQC,IAAIF,EAAIG,YACN,QAAS,iCClCfC,EAAUC,OAAO,+GCIjBC,EAAS1B,SAAS2B,eAAe,OACjCC,EAAY5B,SAASC,cAAc,eACnC4B,EAAa7B,SAAS2B,eAAe,SACrCG,EAAQ9B,SAAS2B,eAAe,cAChCI,EAAQ/B,SAAS2B,eAAe,aAChCK,EAAYhC,SAASC,cAAc,uBAGrCyB,EAAAA,CCdsBO,CAAAA,IAEzBC,SAASC,YAAc,mGAEnBC,EAAAA,IAAUF,SAASG,IAAAA,CACtBC,UAAW,MACXC,MAAO,sDAEPC,KAAM,EAENC,YAAY,UAGPC,EAAAA,IAAaR,SAASS,aAE5BV,EAAUW,SAAQC,UAEX9C,EAAKC,SAAS8C,cAAc,OAClC/C,EAAGgD,UAAY,aAEXb,SAASc,OAAAA,CACZC,QAASlD,EACTmD,OAAQ,WACNC,UAAUN,EAAIO,aAAaC,MAAMjB,OAEhCF,SAASoB,MAAAA,CACZC,OAAQ,KACNJ,UAAUN,EAAIO,aAAaI,QAAAA,UAAkBX,EAAIY,QAAQZ,EAAIa,mBAAmBL,MAAMjB,GAEzFM,EAAOiB,OAAOd,EAAIO,gBAGnBhB,EAAIwB,UAAUlB,EAAAA,CACbmB,QAAAA,CACCC,IAAK,IACLC,OAAQ,IACRC,KAAM,IACNC,MAAO,SDtBSC,KAAKC,MAAMnE,SAAS2B,eAAe,OAAOyC,QAAQnC,YAIjEL,GACHA,EAAUyC,iBAAiB,UAAUC,IACpCA,EAAEC,iBFlBiB3D,OAAO4D,EAAOC,SAWT,mBARN5D,EAAAA,CACjBC,OAAQ,OACRC,IAAK,sBACLC,KAAAA,CACCwD,MAAAA,EACAC,SAAAA,MAGMzD,KAAKC,WACF,UAAW,sBACrBR,OAAOC,YAAW,KACjBQ,SAASwD,OAAO,OACd,aAEItD,KACE,QAASA,EAAIG,SAASP,KAAK2D,YECvB3E,SAAS2B,eAAe,SAASiD,MAC9B5E,SAAS2B,eAAe,YAAYiD,UAKnD/C,GACHA,EAAWwC,iBAAiB,UAAUC,IACrCA,EAAEC,uBACIM,EAAAA,IAAWC,SACjBD,EAAKE,OAAO,OAAQ/E,SAAS2B,eAAe,QAAQiD,OACpDC,EAAKE,OAAO,QAAS/E,SAAS2B,eAAe,SAASiD,OACtDC,EAAKE,OAAO,QAAS/E,SAAS2B,eAAe,SAASqD,MAAM,IFMpCpE,OAAAA,QASA,mBAPNC,EAAAA,CACjBC,OAAQ,QACRC,IAAK,yBACLC,KAAAA,KAIOA,KAAKC,WACF,UAAW,6BACrBR,OAAOC,YAAW,KACjBQ,SAASC,QAAO,KACd,YAEIC,GACRC,QAAQC,IAAIF,EAAIG,YACN,QAAS,kCEtBRsD,MAKT/C,GACHA,EAAMuC,iBAAiB,UAAUC,IAChCA,EAAEC,iBFmByB3D,OAAOqE,EAASR,EAAUS,SAa7B,mBAXNrE,EAAAA,CACjBC,OAAQ,QACRC,IAAK,+BACLC,KAAAA,CACCiE,QAAAA,EACAR,SAAAA,EACAS,gBAAAA,MAKMlE,KAAKC,WACF,UAAW,iCACrBR,OAAOC,YAAW,KACjBQ,SAASC,QAAO,KACd,YAEIC,GACRC,QAAQC,IAAIF,EAAIG,YACN,QAAS,kCEvCHvB,SAASC,cAAc,YAAY2E,MAClC5E,SAASC,cAAc,aAAa2E,MAC7B5E,SAASC,cAAc,oBAAoB2E,UAKjE7C,GACHA,EAAMsC,iBAAiB,SAASC,ID/CT1D,OAAAA,cAEhBuE,QAAgBtE,EAAAA,qCAA2CuE,WAE3D5D,EAAO6D,mBAAAA,CACZC,UAAUH,EAAQnE,KAAKmE,QAAQI,WAExBnE,GACRC,QAAQC,IAAIF,EAAIG,YACN,QAAS,2CCuCN+C,EAAEkB,OAAOpB,QAAQqB,WAK5BzD,GACHA,EAAUqC,iBAAiB,QAAA1D","sources":["./node_modules/@parcel/scope-hoisting/lib/helpers.js","./public/js/alerts.js","./public/js/login.js","./public/js/stripe.js","./public/js/index.js","./public/js/mapbox.js"],"sourcesContent":["var $parcel$global =\n  typeof globalThis !== 'undefined'\n    ? globalThis\n    : typeof self !== 'undefined'\n    ? self\n    : typeof window !== 'undefined'\n    ? window\n    : typeof global !== 'undefined'\n    ? global\n    : {};\n\nfunction $parcel$interopDefault(a) {\n  return a && a.__esModule ? a.default : a;\n}\n\nfunction $parcel$defineInteropFlag(a) {\n  Object.defineProperty(a, '__esModule', {value: true});\n}\n\nfunction $parcel$export(e, n, v) {\n  Object.defineProperty(e, n, {get: v, enumerable: true});\n}\n\nfunction $parcel$exportWildcard(dest, source) {\n  Object.keys(source).forEach(function(key) {\n    if (key === 'default' || key === '__esModule') {\n      return;\n    }\n\n    Object.defineProperty(dest, key, {\n      enumerable: true,\n      get: function get() {\n        return source[key];\n      },\n    });\n  });\n\n  return dest;\n}\n\nfunction $parcel$missingModule(name) {\n  var err = new Error(\"Cannot find module '\" + name + \"'\");\n  err.code = 'MODULE_NOT_FOUND';\n  throw err;\n}\n","export const hideAlert = () => {\r\n\tconst el =  document.querySelector('.alert');\r\n\tif (el) el.parentElement.removeChild(el);\r\n}\r\n\r\nexport const showAlert = (type, msg) => {\r\n\thideAlert();\r\n\tconst markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\r\n\tdocument.querySelector('body').insertAdjacentHTML('afterbegin', markup);\r\n\twindow.setTimeout(hideAlert, 5000);\r\n}","import axios from 'axios';\r\nimport {showAlert} from './alerts';\r\n\r\nexport const login = async (email, password) => {\r\n\r\n\ttry {\r\n\t\tconst res = await axios({\r\n\t\t\tmethod: 'POST',\r\n\t\t\turl: '/api/v1/users/login',\r\n\t\t\tdata:{\r\n\t\t\t\temail,\r\n\t\t\t\tpassword\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (res.data.status === \"success\") {\r\n\t\t\tshowAlert('success', 'Log in successfull');\r\n\t\t\twindow.setTimeout(() => {\r\n\t\t\t\tlocation.assign('/')\r\n\t\t\t}, 1500);\r\n\t\t}\r\n\t} catch (err) {\r\n\t\tshowAlert('error', err.response.data.message);\r\n\t}\r\n}\r\n\r\nexport const logout = async () => {\r\n\ttry {\r\n\t\tconst res = await axios({\r\n\t\t\tmethod: 'GET',\r\n\t\t\turl: '/api/v1/users/logout',\r\n\t\t});\r\n\r\n\t\t//reload from server not browser cache\r\n\t\tif (res.data.status === \"success\") location.reload(true);\r\n\t} catch (err) {\r\n\t\tconsole.log(err.response);\r\n\t\tshowAlert('error', 'Error logging out try again');\r\n\t}\r\n}\r\n\r\nexport const updateUser = async (data) => {\r\n\ttry {\r\n\t\tconst res = await axios({\r\n\t\t\tmethod: 'PATCH',\r\n\t\t\turl: '/api/v1/users/updateme',\r\n\t\t\tdata\r\n\t\t});\r\n\r\n\t\t//reload from server not browser cache\r\n\t\tif (res.data.status === \"success\") {\r\n\t\t\tshowAlert('success', 'Data updated successfully');\r\n\t\t\twindow.setTimeout(() => {\r\n\t\t\t\tlocation.reload(true);\r\n\t\t\t}, 500);\r\n\t\t}\r\n\t} catch (err) {\r\n\t\tconsole.log(err.response);\r\n\t\tshowAlert('error', 'Error logging out try again');\r\n\t}\r\n}\r\n\r\nexport const updatePssword = async (current, password, passwordConfirm) => {\r\n\ttry {\r\n\t\tconst res = await axios({\r\n\t\t\tmethod: 'PATCH',\r\n\t\t\turl: '/api/v1/users/updatepassword',\r\n\t\t\tdata:{\r\n\t\t\t\tcurrent,\r\n\t\t\t\tpassword, \r\n\t\t\t\tpasswordConfirm\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t//reload from server not browser cache\r\n\t\tif (res.data.status === \"success\") {\r\n\t\t\tshowAlert('success', 'Password updated successfully');\r\n\t\t\twindow.setTimeout(() => {\r\n\t\t\t\tlocation.reload(true);\r\n\t\t\t}, 500);\r\n\t\t}\r\n\t} catch (err) {\r\n\t\tconsole.log(err.response);\r\n\t\tshowAlert('error', 'Error logging out try again');\r\n\t}\r\n}","import axios from 'axios';\r\nimport {showAlert} from './alerts';\r\nconst stripe =  Stripe('pk_test_51IcfmMHseh8kuJW4a5jED3Vg6hLk8GaFzB2NMcX31CYwwtrOdsY0In5h1mNn4qClOGtff4xBN358c9e2BlzFSs1400sbqf6RqC')\r\n\r\nexport const bookTour = async tourId => {\r\n\ttry {\r\n\t\tconst session = await axios(`/api/v1/bookings/checkout-session/${tourId}`);\r\n\r\n\t\tawait stripe.redirectToCheckout({\r\n\t\t\tsessionId:session.data.session.id\r\n\t\t});\r\n\t} catch (err) {\r\n\t\tconsole.log(err.response);\r\n\t\tshowAlert('error', 'Error cannot access payment platform');\r\n\t}\r\n}","import '@babel/polyfill'\r\nimport { displayMap } from './mapbox';\r\nimport { login, logout, updateUser, updatePssword } from './login';\r\nimport { bookTour } from './stripe';\r\n\r\n\r\nconst mapBox = document.getElementById('map');\r\nconst loginForm = document.querySelector('.form-login');\r\nconst updateForm = document.getElementById('jones');\r\nconst Upass = document.getElementById('updatepass');\r\nconst books = document.getElementById('book-tour');\r\nconst logoutBtn = document.querySelector('.nav__el--logout');\r\n\r\n\r\nif (mapBox) {\r\n\tconst locations = JSON.parse(document.getElementById('map').dataset.locations);\r\n\tdisplayMap(locations);\r\n}\r\n\r\nif (loginForm) {\r\n\tloginForm.addEventListener('submit', e => {\r\n\t\te.preventDefault();\r\n\t\tconst email = document.getElementById('email').value;\r\n\t\tconst password = document.getElementById('password').value;\r\n\t\tlogin(email, password);\r\n\t})\r\n}\r\n\r\nif (updateForm) {\r\n\tupdateForm.addEventListener('submit', e => {\r\n\t\te.preventDefault();\r\n\t\tconst form = new FormData();\r\n\t\tform.append('name', document.getElementById('name').value);\r\n\t\tform.append('email', document.getElementById('email').value);\r\n\t\tform.append('photo', document.getElementById('photo').files[0]);\r\n\t\tupdateUser(form);\r\n\t})\r\n}\r\n\r\n\r\nif (Upass) {\r\n\tUpass.addEventListener('submit', e => {\r\n\t\te.preventDefault();\r\n\t\tconst current = document.querySelector('.current').value;\r\n\t\tconst password = document.querySelector('.password').value;\r\n\t\tconst passwordConfirm = document.querySelector('.confirmPassword').value;\r\n\t\tupdatePssword(current, password, passwordConfirm);\r\n\t});\r\n}\r\n\r\nif (books) {\r\n\tbooks.addEventListener('click', e => { \r\n\t\tconst tour = e.target.dataset.tourid;\r\n\t\tbookTour(tour);\r\n\t})\r\n}\r\n\r\nif (logoutBtn) {\r\n\tlogoutBtn.addEventListener('click',logout)\r\n}","export const displayMap = locations => {\r\n\t\r\n\tmapboxgl.accessToken = 'pk.eyJ1Ijoid2hvaXNhYm9uIiwiYSI6ImNrbXAwMzdoczI5cXQyb2w4ODZxM3UzYjkifQ.3IHdIgc38r-Dr7U5qsWTeg';\r\n\t\r\n\tvar map = new mapboxgl.Map({\r\n\t\tcontainer: 'map',\r\n\t\tstyle: 'mapbox://styles/whoisabon/ckmp24lvx3tem17s22da3708e',\r\n\t\t// center: [-118.3406, 34.8358],\r\n\t\tzoom: 7,\r\n\t\t//interactive: false,\r\n\t\tscrollZoom: false\r\n\t});\r\n\r\n\tconst bounds = new mapboxgl.LngLatBounds();\r\n\r\n\tlocations.forEach(loc => {\r\n\r\n\t\tconst el = document.createElement('div');\r\n\t\tel.className = 'marker';\r\n\r\n\t\tnew mapboxgl.Marker({\r\n\t\t\telement: el,\r\n\t\t\tanchor: 'bottom'\r\n\t\t}).setLngLat(loc.coordinates).addTo(map);\r\n\r\n\t\tnew mapboxgl.Popup({\r\n\t\t\toffset: 30\r\n\t\t}).setLngLat(loc.coordinates).setHTML(`<p>Day ${loc.day}: ${loc.description}</p>`).addTo(map);\r\n\r\n\t\tbounds.extend(loc.coordinates);\r\n\t});\r\n\r\n\tmap.fitBounds(bounds, {\r\n\t\tpadding: {\r\n\t\t\ttop: 200,\r\n\t\t\tbottom: 150,\r\n\t\t\tleft: 100,\r\n\t\t\tright: 100\r\n\t\t}\r\n\t});\r\n}"],"names":["a","__esModule","default","$97d2ad8c7f44f237d5151899546ef663$export$hideAlert","el","document","querySelector","parentElement","removeChild","$97d2ad8c7f44f237d5151899546ef663$export$showAlert","type","msg","markup","insertAdjacentHTML","window","setTimeout","$4f3cbe766f01e8dd87f72977be7a8297$export$logout","async","_axios","method","url","data","status","location","reload","err","console","log","response","$e6d21863eea64f1264e884e5282aaa57$var$stripe","Stripe","$5a000f673dd6ffb894f1a72dee6e56d0$var$mapBox","getElementById","$5a000f673dd6ffb894f1a72dee6e56d0$var$loginForm","$5a000f673dd6ffb894f1a72dee6e56d0$var$updateForm","$5a000f673dd6ffb894f1a72dee6e56d0$var$Upass","$5a000f673dd6ffb894f1a72dee6e56d0$var$books","$5a000f673dd6ffb894f1a72dee6e56d0$var$logoutBtn","locations","mapboxgl","accessToken","map","Map","container","style","zoom","scrollZoom","bounds","LngLatBounds","forEach","loc","createElement","className","Marker","element","anchor","setLngLat","coordinates","addTo","Popup","offset","setHTML","day","description","extend","fitBounds","padding","top","bottom","left","right","JSON","parse","dataset","addEventListener","e","preventDefault","email","password","assign","message","value","form","FormData","append","files","current","passwordConfirm","session","tourId","redirectToCheckout","sessionId","id","target","tourid"],"version":3,"file":"index.js.map"}